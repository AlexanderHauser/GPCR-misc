import csv
from collections import defaultdict
from pprint import pprint

'''
# Code to be put at the GPCRdb tree making view
    for p in class_proteins:
        #print(p,p.family.slug)
        fid = p.family.slug.split("_")
        print(fid[0], fid[1], fid[2], fid[3], p.entry_name.split("_")[0])
'''

def tree(): return defaultdict(tree)

def tree_add(t, path):
  for node in path:
    t = t[node]

def pprint_tree(tree_instance):
    def dicts(t): return {k: dicts(t[k]) for k in t}
    pprint(dicts(tree_instance))

def csv_to_tree(input):
    t = tree()
    for row in csv.reader(input, quotechar='\''):
        tree_add(t, row)
    return t

def tree_to_newick(root):
    items = []
    for k in root.iterkeys():
        s = ''
        if len(root[k].keys()) > 0:
            sub_tree = tree_to_newick(root[k])
            if sub_tree != '':
                s += '(' + sub_tree + ')'
        s += k
        items.append(s)
    return ','.join(items)

def csv_to_weightless_newick(input):
    t = csv_to_tree(input)
    #pprint_tree(t)
    return tree_to_newick(t)

if __name__ == '__main__':
    # see https://docs.python.org/2/library/csv.html to read CSV file
    input = ["'001','001','001','001','5HT1A'",
"'001','001','001','002','5HT1B'",
"'001','001','001','003','5HT1D'",
"'001','001','001','004','5HT1E'",
"'001','001','001','005','5HT1F'",
"'001','001','001','006','5HT2A'",
"'001','001','001','007','5HT2B'",
"'001','001','001','008','5HT2C'",
"'001','001','001','009','5HT4R'",
"'001','001','001','010','5HT5A'",
"'001','001','001','012','5HT6R'",
"'001','001','001','013','5HT7R'",
"'001','001','002','001','ACM1'",
"'001','001','002','002','ACM2'",
"'001','001','002','003','ACM3'",
"'001','001','002','004','ACM4'",
"'001','001','002','005','ACM5'",
"'001','001','003','001','ADA1A'",
"'001','001','003','002','ADA1B'",
"'001','001','003','003','ADA1D'",
"'001','001','003','004','ADA2A'",
"'001','001','003','005','ADA2B'",
"'001','001','003','006','ADA2C'",
"'001','001','003','007','ADRB1'",
"'001','001','003','008','ADRB2'",
"'001','001','003','009','ADRB3'",
"'001','001','004','001','DRD1'",
"'001','001','004','002','DRD2'",
"'001','001','004','003','DRD3'",
"'001','001','004','004','DRD4'",
"'001','001','004','005','DRD5'",
"'001','001','005','001','HRH1'",
"'001','001','005','002','HRH2'",
"'001','001','005','003','HRH3'",
"'001','001','005','004','HRH4'",
"'001','001','006','001','TAAR1'",
"'001','002','001','001','AGTR1'",
"'001','002','001','002','AGTR2'",
"'001','002','002','001','APJ'",
"'001','002','003','001','NMBR'",
"'001','002','003','002','GRPR'",
"'001','002','003','003','BRS3'",
"'001','002','004','001','BKRB1'",
"'001','002','004','002','BKRB2'",
"'001','002','005','001','CCKAR'",
"'001','002','005','002','GASR'",
"'001','002','006','001','C3AR'",
"'001','002','006','002','C5AR1'",
"'001','002','006','003','C5AR2'",
"'001','002','007','001','EDNRA'",
"'001','002','007','002','EDNRB'",
"'001','002','008','001','FPR1'",
"'001','002','008','002','FPR2'",
"'001','002','008','003','FPR3'",
"'001','002','009','001','GALR1'",
"'001','002','009','002','GALR2'",
"'001','002','009','003','GALR3'",
"'001','002','010','001','GHSR'",
"'001','002','011','001','GNRHR'",
"'001','002','011','002','GNRR2'",
"'001','002','012','001','KISSR'",
"'001','002','013','001','MCHR1'",
"'001','002','013','002','MCHR2'",
"'001','002','014','001','MSHR'",
"'001','002','014','002','ACTHR'",
"'001','002','014','003','MC3R'",
"'001','002','014','004','MC4R'",
"'001','002','014','005','MC5R'",
"'001','002','015','001','MTLR'",
"'001','002','016','001','NMUR1'",
"'001','002','016','002','NMUR2'",
"'001','002','017','001','NPFF1'",
"'001','002','017','002','NPFF2'",
"'001','002','018','001','NPSR1'",
"'001','002','019','001','NPBW1'",
"'001','002','019','002','NPBW2'",
"'001','002','020','001','NPY1R'",
"'001','002','020','002','NPY2R'",
"'001','002','020','003','NPY4R'",
"'001','002','020','004','NPY5R'",
"'001','002','020','005','NPY6R'",
"'001','002','021','001','NTR1'",
"'001','002','021','002','NTR2'",
"'001','002','022','001','OPRD'",
"'001','002','022','002','OPRK'",
"'001','002','022','003','OPRM'",
"'001','002','022','004','OPRX'",
"'001','002','023','001','OX1R'",
"'001','002','023','002','OX2R'",
"'001','002','024','001','QRFPR'",
"'001','002','025','001','PRLHR'",
"'001','002','026','001','PAR1'",
"'001','002','026','002','PAR2'",
"'001','002','026','003','PAR3'",
"'001','002','026','004','PAR4'",
"'001','002','027','001','RXFP1'",
"'001','002','027','002','RXFP2'",
"'001','002','027','003','RL3R1'",
"'001','002','027','004','RL3R2'",
"'001','002','028','001','SSR1'",
"'001','002','028','002','SSR2'",
"'001','002','028','003','SSR3'",
"'001','002','028','004','SSR4'",
"'001','002','028','005','SSR5'",
"'001','002','029','001','NK1R'",
"'001','002','029','002','NK2R'",
"'001','002','029','003','NK3R'",
"'001','002','030','001','TRFR'",
"'001','002','031','001','UR2R'",
"'001','002','032','001','V1AR'",
"'001','002','032','002','V1BR'",
"'001','002','032','003','V2R'",
"'001','002','032','004','OXYR'",
"'001','003','001','001','CML1'",
"'001','003','002','001','CCR1'",
"'001','003','002','002','CCR2'",
"'001','003','002','003','CCR3'",
"'001','003','002','004','CCR4'",
"'001','003','002','005','CCR5'",
"'001','003','002','006','CCR6'",
"'001','003','002','007','CCR7'",
"'001','003','002','008','CCR8'",
"'001','003','002','009','CCR9'",
"'001','003','002','010','CCR10'",
"'001','003','002','011','CXCR1'",
"'001','003','002','012','CXCR2'",
"'001','003','002','013','CXCR3'",
"'001','003','002','014','CXCR4'",
"'001','003','002','015','CXCR5'",
"'001','003','002','016','CXCR6'",
"'001','003','002','017','CX3C1'",
"'001','003','002','018','XCR1'",
"'001','003','002','019','ACKR1'",
"'001','003','002','020','ACKR2'",
"'001','003','002','021','ACKR3'",
"'001','003','002','022','ACKR4'",
"'001','003','002','023','CCRL2'",
"'001','003','003','001','FSHR'",
"'001','003','003','002','LSHR'",
"'001','003','003','003','TSHR'",
"'001','003','004','001','PKR1'",
"'001','003','004','002','PKR2'",
"'001','004','001','001','FFAR1'",
"'001','004','001','002','FFAR2'",
"'001','004','001','003','FFAR3'",
"'001','004','001','004','FFAR4'",
"'001','004','001','005','GPR42'",
"'001','004','002','001','LT4R1'",
"'001','004','002','002','LT4R2'",
"'001','004','002','003','CLTR1'",
"'001','004','002','004','CLTR2'",
"'001','004','002','005','OXER1'",
"'001','004','003','001','LPAR1'",
"'001','004','003','002','LPAR2'",
"'001','004','003','003','LPAR3'",
"'001','004','003','004','LPAR4'",
"'001','004','003','005','LPAR5'",
"'001','004','003','006','LPAR6'",
"'001','004','004','001','S1PR1'",
"'001','004','004','002','S1PR2'",
"'001','004','004','003','S1PR3'",
"'001','004','004','004','S1PR4'",
"'001','004','004','005','S1PR5'",
"'001','004','005','001','CNR1'",
"'001','004','005','002','CNR2'",
"'001','004','006','001','GPR18'",
"'001','004','006','002','GPR55'",
"'001','004','006','003','GP119'",
"'001','004','007','001','PTAFR'",
"'001','004','008','001','PD2R'",
"'001','004','008','002','PD2R2'",
"'001','004','008','003','PE2R1'",
"'001','004','008','004','PE2R2'",
"'001','004','008','005','PE2R3'",
"'001','004','008','006','PE2R4'",
"'001','004','008','007','PF2R'",
"'001','004','008','008','PI2R'",
"'001','004','008','009','TA2R'",
"'001','005','001','001','MTR1A'",
"'001','005','001','002','MTR1B'",
"'001','006','001','001','AA1R'",
"'001','006','001','002','AA2AR'",
"'001','006','001','003','AA2BR'",
"'001','006','001','004','AA3R'",
"'001','006','002','001','P2RY1'",
"'001','006','002','002','P2RY2'",
"'001','006','002','003','P2RY4'",
"'001','006','002','004','P2RY6'",
"'001','006','002','005','P2Y11'",
"'001','006','002','006','P2Y12'",
"'001','006','002','007','P2Y13'",
"'001','006','002','008','P2Y14'",
"'001','007','001','001','GPBAR'",
"'001','007','002','001','GPER1'",
"'001','008','001','001','HCAR1'",
"'001','008','001','002','HCAR2'",
"'001','008','001','003','HCAR3'",
"'001','008','002','001','OXGR1'",
"'001','008','003','001','SUCR1'",
"'001','009','001','001','OPSD'",
"'001','009','001','002','OPN4'",
"'001','009','001','003','OPN3'",
"'001','009','001','004','OPN5'",
"'001','009','001','005','OPSB'",
"'001','009','001','006','OPSG'",
"'001','009','001','007','OPSR'",
"'001','010','001','001','GPR1'",
"'001','010','001','003','GPR3'",
"'001','010','001','004','GPR4'",
"'001','010','001','005','GPR6'",
"'001','010','001','006','GPR12'",
"'001','010','001','007','GPR15'",
"'001','010','001','008','GPR17'",
"'001','010','001','010','GPR19'",
"'001','010','001','011','GPR20'",
"'001','010','001','012','GPR21'",
"'001','010','001','013','GPR22'",
"'001','010','001','014','GPR25'",
"'001','010','001','015','GPR26'",
"'001','010','001','016','GPR27'",
"'001','010','001','017','GPR31'",
"'001','010','001','018','GPR32'",
"'001','010','001','019','GPR33'",
"'001','010','001','020','GPR34'",
"'001','010','001','021','GPR35'",
"'001','010','001','022','GPR37'",
"'001','010','001','023','ETBR2'",
"'001','010','001','024','GPR39'",
"'001','010','001','026','GPR45'",
"'001','010','001','027','MTR1L'",
"'001','010','001','028','GPR52'",
"'001','010','001','030','GPR61'",
"'001','010','001','031','GPR62'",
"'001','010','001','032','GPR63'",
"'001','010','001','033','PSYR'",
"'001','010','001','034','OGR1'",
"'001','010','001','035','GPR75'",
"'001','010','001','036','GPR78'",
"'001','010','001','038','GPR82'",
"'001','010','001','039','GPR83'",
"'001','010','001','040','GPR84'",
"'001','010','001','041','GPR85'",
"'001','010','001','042','GPR87'",
"'001','010','001','043','GPR88'",
"'001','010','001','044','GP101'",
"'001','010','001','046','GP132'",
"'001','010','001','047','GP135'",
"'001','010','001','048','GP139'",
"'001','010','001','049','GP141'",
"'001','010','001','050','GP142'",
"'001','010','001','051','GP146'",
"'001','010','001','052','GP148'",
"'001','010','001','053','GP149'",
"'001','010','001','054','GP150'",
"'001','010','001','055','GP151'",
"'001','010','001','056','GP152'",
"'001','010','001','057','GP153'",
"'001','010','001','058','GP160'",
"'001','010','001','059','GP161'",
"'001','010','001','060','GP162'",
"'001','010','001','061','GP171'",
"'001','010','001','062','GP173'",
"'001','010','001','063','GP174'",
"'001','010','001','064','GP176'",
"'001','010','001','065','GP182'",
"'001','010','001','066','GP183'",
"'001','010','001','067','LGR4'",
"'001','010','001','068','LGR5'",
"'001','010','001','069','LGR6'",
"'001','010','001','070','MAS'",
"'001','010','001','071','MAS1L'",
"'001','010','001','072','MRGRD'",
"'001','010','001','073','MRGRE'",
"'001','010','001','074','MRGRF'",
"'001','010','001','075','MRGRG'",
"'001','010','001','076','MRGX1'",
"'001','010','001','077','MRGX2'",
"'001','010','001','078','MRGX3'",
"'001','010','001','079','MRGX4'",
"'001','010','001','083','P2RY8'",
"'001','010','001','084','P2Y10'",
"'001','010','001','085','TAAR2'",
"'001','010','001','086','TAAR3'",
"'001','010','001','088','TAAR5'",
"'001','010','001','089','TAAR6'",
"'001','010','001','090','TAAR8'",
"'001','010','001','091','TAAR9'",
"'002','001','001','001','CALCR'",
"'002','001','001','005','CALRL'",
"'002','001','002','001','CRFR1'",
"'002','001','002','002','CRFR2'",
"'002','001','003','001','GHRHR'",
"'002','001','003','002','GIPR'",
"'002','001','003','003','GLP1R'",
"'002','001','003','004','GLP2R'",
"'002','001','003','005','GLR'",
"'002','001','003','006','SCTR'",
"'002','001','004','001','PTH1R'",
"'002','001','004','002','PTH2R'",
"'002','001','005','001','PACR'",
"'002','001','005','002','VIPR1'",
"'002','001','005','003','VIPR2'",
"'003','001','001','001','AGRL1'",
"'003','001','001','002','AGRL2'",
"'003','001','001','003','AGRL3'",
"'003','001','002','001','AGRE1'",
"'003','001','002','002','AGRE2'",
"'003','001','002','003','AGRE3'",
"'003','001','002','004','AGRE4'",
"'003','001','002','005','CD97'",
"'003','001','003','001','AGRA1'",
"'003','001','003','002','AGRA2'",
"'003','001','003','003','AGRA3'",
"'003','001','004','001','CELR1'",
"'003','001','004','002','CELR2'",
"'003','001','004','003','CELR3'",
"'003','001','005','001','AGRD1'",
"'003','001','005','002','AGRD2'",
"'003','001','006','001','AGRF1'",
"'003','001','006','002','AGRF2'",
"'003','001','006','003','AGRF3'",
"'003','001','006','004','AGRF4'",
"'003','001','006','005','AGRF5'",
"'003','001','007','001','BAI1'",
"'003','001','007','002','AGRB2'",
"'003','001','007','003','AGRB3'",
"'003','001','008','001','AGRG1'",
"'003','001','008','002','AGRG2'",
"'003','001','008','003','AGRG3'",
"'003','001','008','004','AGRG4'",
"'003','001','008','005','AGRG5'",
"'003','001','008','006','GP126'",
"'003','001','008','007','AGRG7'",
"'003','001','008','008','AGRL4'",
"'003','001','009','001','GPR98'",
"'004','001','001','001','CASR'",
"'004','001','001','002','GPC6A'",
"'004','002','001','001','GABR1'",
"'004','002','001','002','GABR2'",
"'004','002','002','001','GRM1'",
"'004','002','002','002','GRM2'",
"'004','002','002','003','GRM3'",
"'004','002','002','004','GRM4'",
"'004','002','002','005','GRM5'",
"'004','002','002','006','GRM6'",
"'004','002','002','007','GRM7'",
"'004','002','002','008','GRM8'",
"'004','003','001','001','TS1R1'",
"'004','003','001','002','TS1R2'",
"'004','003','001','003','TS1R3'",
"'004','004','001','001','GP156'",
"'004','004','001','002','GP158'",
"'004','004','001','003','GP179'",
"'004','004','001','004','RAI3'",
"'004','004','001','005','GPC5B'",
"'004','004','001','006','GPC5C'",
"'004','004','001','007','GPC5D'",
"'005','001','001','001','FZD1'",
"'005','001','001','002','FZD2'",
"'005','001','001','003','FZD3'",
"'005','001','001','004','FZD4'",
"'005','001','001','005','FZD5'",
"'005','001','001','006','FZD6'",
"'005','001','001','007','FZD7'",
"'005','001','001','008','FZD8'",
"'005','001','001','009','FZD9'",
"'005','001','001','010','FZD10'",
"'005','001','001','011','SMO'",
"'006','001','001','001','TA2R1'",
"'006','001','001','002','TA2R3'",
"'006','001','001','003','TA2R4'",
"'006','001','001','004','TA2R5'",
"'006','001','001','005','TA2R7'",
"'006','001','001','006','TA2R8'",
"'006','001','001','007','TA2R9'",
"'006','001','001','008','T2R10'",
"'006','001','001','009','T2R13'",
"'006','001','001','010','T2R14'",
"'006','001','001','011','T2R16'",
"'006','001','001','012','T2R19'",
"'006','001','001','013','T2R20'",
"'006','001','001','014','T2R30'",
"'006','001','001','015','T2R31'",
"'006','001','001','016','T2R38'",
"'006','001','001','017','T2R39'",
"'006','001','001','018','T2R40'",
"'006','001','001','019','T2R41'",
"'006','001','001','020','T2R42'",
"'006','001','001','021','T2R43'",
"'006','001','001','022','T2R45'",
"'006','001','001','023','T2R46'",
"'006','001','001','024','T2R50'",
"'006','001','001','025','T2R60'",
"'007','001','001','001','GP107'",
"'007','001','001','002','G137A'",
"'007','001','001','003','O51E1'",
"'007','001','001','004','TPRA1'",
"'007','001','001','005','GP143'",
"'007','001','001','006','GP157'"
    ]

    print csv_to_weightless_newick(input)